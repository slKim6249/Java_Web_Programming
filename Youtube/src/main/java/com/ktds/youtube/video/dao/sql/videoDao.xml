<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="VideoDao">
  
  	<insert id="insertOneVideo" parameterType="VideoVO">
  		INSERT INTO MOVIE (
			   VIDEO_ID
			   , CHANNEL_ID
			   , TITLE
			   , UPLOAD_ID
			   , RUNNING_TIME
			   , VIEW_COUNT
			   , UPLOAD_DATE
			   , POSTER_PATH
			   , VIDEO_PATH
			  ) 
		VALUES ( 
				'VO-' || TO_CHAR(SYSDATE, 'YYYYMMDDHH24')
						|| '-'
						|| LPAD(VIDEO_ID_SEQ.NEXTVAL, 6, '0') 
				, '1'
				, #{title} 
				, #{uploaderId}
			 	, 120
			 	, 0 
			 	, SYSDATE 
			 	, #{posterPath} 
			 	, #{videoPath} 
			 )
  	</insert>
  	
  	<update id="updateOneVideo" parameterType="VideoVO">
  	
  	</update>
  	
  	<delete id="deleteOneVideo" parameterType="string">
  		DELETE
  		FROM	MOVIE
  		WHERE	VIDEO_ID = #{videoId}
  	</delete>
  	
  	<select id="selectOneVideo" parameterType="string" resultMap="videoResultMap">
  		SELECT	VIDEO_ID videoId
				, CHANNEL_ID channelId
				, TITLE title
				, UPLOAD_ID uploaderId
				, RUNNING_TIME runningTime
				, VIEW_COUNT viewCount
				, UPLOAD_DATE uploadDate
				, POSTER_PATH posterPath
				, VIDEO_PATH videoPath
		FROM MOVIE
		WHERE	VIDEO_ID = #{videoId}
  	</select>
  	
  	<resultMap type="VideoVO" id="videoResultMap">
		<id property="videoId" column="VIDEO_ID" />
		<result property="channelId" column="CHANNEL_ID" />
		<result property="title" column="TITLE" />
		<result property="uploaderId" column="UPLOAD_ID" />
		<result property="runningTime" column="RUNNING_TIME" />
		<result property="viewCount" column="VIEW_COUNT" />
		<result property="uploaddate" column="UPLOAD_DATE" />
		<result property="posterPath" column="POSTER_PATH" />
		<result property="videoPath" column="VIDEO_PATH" />
  	</resultMap>
  	
  	<select id="selectAllVideos" resultMap="videoResultMap">
  		SELECT	VIDEO_ID videoId
				, CHANNEL_ID channelId
				, TITLE title
				, UPLOAD_ID uploaderId
				, RUNNING_TIME runningTime
				, VIEW_COUNT viewCount
				, UPLOAD_DATE uploadDate
				, POSTER_PATH posterPath
				, VIDEO_PATH videoPath
		FROM MOVIE
  	</select>
  	
  	
  </mapper>